<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Neon Runner</title>
  <style>
    body {
      margin: 0;
      background: black;
      overflow: hidden;
    }
    canvas {
      display: block;
      background: linear-gradient(to top, #000, #111);
    }
  </style>
</head>
<body>
<canvas id="game"></canvas>
<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let gravity = 0.8;
let jumpStrength = -15;
let score = 0;
let obstacles = [];

const player = {
  x: 100,
  y: canvas.height - 150,
  width: 50,
  height: 50,
  dy: 0,
  grounded: true,
  color: "lime"
};

document.addEventListener("keydown", e => {
  if ((e.code === "Space" || e.code === "ArrowUp") && player.grounded) {
    player.dy = jumpStrength;
    player.grounded = false;
  }
});

class Obstacle {
  constructor() {
    this.width = 50;
    this.height = 50;
    this.x = canvas.width;
    this.y = canvas.height - 150;
    this.color = "magenta";
    this.speed = 8;
  }
  update() {
    this.x -= this.speed;
    ctx.fillStyle = this.color;
    ctx.fillRect(this.x, this.y, this.width, this.height);
  }
}

function spawnObstacle() {
  obstacles.push(new Obstacle());
}

let obstacleTimer = 0;

function update() {
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // draw ground
  ctx.fillStyle = "lime";
  ctx.fillRect(0, canvas.height - 100, canvas.width, 5);

  // update player
  player.y += player.dy;
  player.dy += gravity;

  if (player.y + player.height >= canvas.height - 100) {
    player.y = canvas.height - 100 - player.height;
    player.dy = 0;
    player.grounded = true;
  }

  ctx.fillStyle = player.color;
  ctx.fillRect(player.x, player.y, player.width, player.height);

  // obstacles
  obstacleTimer++;
  if (obstacleTimer % 120 === 0) { // every ~2 seconds
    spawnObstacle();
  }

  for (let i = obstacles.length-1; i>=0; i--) {
    obstacles[i].update();
    if (obstacles[i].x + obstacles[i].width < 0) {
      obstacles.splice(i,1);
      score++;
    }

    // collision check
    if (
      player.x < obstacles[i].x + obstacles[i].width &&
      player.x + player.width > obstacles[i].x &&
      player.y < obstacles[i].y + obstacles[i].height &&
      player.y + player.height > obstacles[i].y
    ) {
      alert("Game Over! Final Score: " + score);
      document.location.reload();
    }
  }

  // score
  ctx.fillStyle = "white";
  ctx.font = "24px Arial";
  ctx.fillText("Score: " + score, 20, 40);

  requestAnimationFrame(update);
}
update();
</script>
</body>
</html>
